function t(e){return e&&"function"==typeof e.arrayBuffer?e.arrayBuffer().then(e=>t(new Uint8Array(e))):new Promise(t=>{const n=document.createElement("canvas"),o=n.getContext("2d"),a=Math.ceil(Math.sqrt(e.length/3+1)),r=n.width=a,c=n.height=a,i=o.getImageData(0,0,r,c);!function(t=[],e=[]){for(let n=0,o=t.length;n<3;n++)e[n]=o/Math.pow(256,n)%256|0;e[3]=255;for(let n=4,o=0,a=e.length;n<a;n+=4,o+=3)e[n]=t[o]||0,e[n+1]=t[o+1]||0,e[n+2]=t[o+2]||0,e[n+3]=255}(e,i.data),o.putImageData(i,0,0),n.toBlob(t,"image/png")})}function e(t,e="application/octet-binary"){return new Promise((n,o)=>{const a=new Image;a.onload=function(){const t=document.createElement("canvas"),o=t.getContext("2d"),r=t.width=a.width,c=t.height=a.height;o.drawImage(a,0,0);const i=function(t=[]){let e=0;for(let n=0;n<3;n++)e+=t[n]*Math.pow(256,n);const n=new Uint8Array(e),o=t.length;for(let a=4,r=0;a<o&&r<e;a+=4,r+=3)for(let o=0;o<3&&r+o<e;o++)n[r+o]=t[a+o];return n}(o.getImageData(0,0,r,c).data);URL.revokeObjectURL(a.src),n(new Blob([i],{type:e}))},a.onerror=o,a.src=URL.createObjectURL(t)})}function n(t,e){return t&&"function"==typeof t.arrayBuffer?t.arrayBuffer().then(t=>n(new Uint8Array(t),e)):e&&"function"==typeof e.arrayBuffer?new Promise((t,n)=>{const o=new Image;o.onload=function(){const e=document.createElement("canvas"),n=e.getContext("2d"),a=e.width=o.width,r=e.height=o.height;n.drawImage(o,0,0);const c=n.getImageData(0,0,a,r);URL.revokeObjectURL(o.src),t(c)},o.onerror=n,o.src=URL.createObjectURL(e)}).then(e=>n(t,e)):new Promise(n=>{const o=document.createElement("canvas"),a=o.getContext("2d");o.width=e.width,o.height=e.height,function(t=[],e=[],n=7){const o=t.length/4,a=e.length,r=Math.pow(n,3)-1,c=o/a|0;for(let i=0,h=0;i<o;i++){const o=4*i;let g=r;h<a&&i%c===0&&(g=e[h++]||0);for(let e=0;e<3;e++){let a=(t[o+e]/n|0)*n;a+n>255&&(a-=n),t[o+e]=g%n+a,g=g/n|0}}}(e.data,t),a.putImageData(e,0,0),o.toBlob(n,"image/png")})}function o(t,e="application/octet-binary"){return new Promise((n,o)=>{const a=new Image;a.onload=function(){const t=document.createElement("canvas"),o=t.getContext("2d"),r=t.width=a.width,c=t.height=a.height;o.drawImage(a,0,0);const i=o.getImageData(0,0,r,c).data;URL.revokeObjectURL(a.src);const h=function(t,e=7){const n=t.length/4,o=[],a=Math.pow(e,3)-1;for(let r=0,c=0;r<n;r++){const n=4*r;let i=0;for(let o=0;o<3;o++){const a=t[n+o];let r=(a/e|0)*e;r+e>255&&(r-=e),i+=(a-r)*Math.pow(e,o)}i<a&&(o[c++]=i)}return new Uint8Array(o)}(i);n(new Blob([h],{type:e}))},a.onerror=o,a.src=URL.createObjectURL(t)})}export{e as decode,t as encode,o as extract,n as inject};
